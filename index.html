<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Packing List</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
    body {
      font-family: Arial, sans-serif;
      background: #f3f3f3;
      margin: 0;
      padding: 20px;
    }

    .page {
      background: white;
      max-width: 900px;
      margin: auto;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.15);
    }

    h1 {
      text-align: center;
      margin-top: 0;
      letter-spacing: 1px;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }

    .header textarea {
      width: 250px;
      height: 90px;
      resize: vertical;
      font-size: 14px;
    }

    .logo {
      width: 160px;
      height: auto;
      object-fit: contain;
    }

    .section {
      margin-top: 20px;
      font-weight: bold;
      text-transform: uppercase;
      font-size: 14px;
    }

    input, textarea {
      width: 100%;
      padding: 6px;
      font-size: 14px;
      margin-top: 4px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 14px;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: left;
    }

    th {
      background: #e7e7e7;
      text-transform: uppercase;
      font-size: 12px;
    }

    .btn {
      padding: 10px 15px;
      border: none;
      background: #0078d7;
      color: white;
      font-size: 14px;
      border-radius: 5px;
      cursor: pointer;
      margin-right: 6px;
      margin-top: 8px;
    }

    .btn-danger {
      background: #c62828;
    }

    .btn-secondary {
      background: #666;
    }

    .signature {
      margin-top: 40px;
      text-align: right;
      font-size: 14px;
    }

    .signature-line {
      width: 250px;
      border-bottom: 1px solid black;
      margin-left: auto;
      margin-bottom: 5px;
      height: 40px;
    }

    @media print {
      body {
        background: white;
        padding: 0;
      }
      .btn, #archive { display: none !important; }
      .page {
        box-shadow: none;
        border-radius: 0;
        margin: 0;
      }
    }
</style>
</head>
<body>

<div class="page">

  <!-- HEADER -->
  <div class="header">
    <textarea id="company">Your Company Name
Street & No
ZIP / City
Country
Phone:
Email:</textarea>

    <img src="logo.png" class="logo">
  </div>

  <h1>Packing List</h1>

  <!-- CUSTOMER INFO -->
  <div class="section">Shipper</div>
  <textarea id="shipper"></textarea>

  <div class="section">Consignee</div>
  <textarea id="consignee"></textarea>

  <!-- META -->
  <div class="section">Details</div>
  <input type="text" id="packingNo" placeholder="Packing List No.">
  <input type="date" id="packingDate">
  <input type="text" id="reference" placeholder="Reference No.">
  <input type="text" id="contact" placeholder="Contact Person">

  <!-- ITEMS TABLE -->
  <div class="section">Items</div>
  <button class="btn btn-secondary" onclick="addRow()">+ Add Item</button>

  <table id="items">
    <thead>
      <tr>
        <th>No.</th>
        <th>Description</th>
        <th>Qty</th>
        <th>Unit</th>
        <th>Net Weight</th>
        <th>Gross Weight</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- NOTES -->
  <div class="section">Notes</div>
  <textarea id="notes" style="height:80px;"></textarea>

  <!-- BUTTONS -->
  <br>
  <button class="btn" onclick="save()">Save to archive</button>
  <button class="btn-secondary btn" onclick="newList()">New packing list</button>
  <button class="btn" onclick="window.print()">Print / Save PDF</button>

  <!-- SIGNATURE -->
  <div class="signature">
    <div class="signature-line"></div>
    Signature
  </div>

</div>

<!-- ARCHIVE -->
<div id="archive" class="page" style="margin-top:20px;">
  <h2>Archive</h2>
  <table id="archiveTable">
    <thead>
      <tr>
        <th>No.</th>
        <th>Date</th>
        <th>Consignee</th>
        <th>Load</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
let STORAGE_KEY = "packing_archive_v2";
let archive = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

function addRow(data = {}) {
  let tbody = document.querySelector("#items tbody");
  let tr = document.createElement("tr");

  tr.innerHTML = `
    <td>${tbody.children.length + 1}</td>
    <td><input value="${data.desc || ""}"></td>
    <td><input type="number" value="${data.qty || ""}"></td>
    <td><input value="${data.unit || ""}"></td>
    <td><input value="${data.net || ""}"></td>
    <td><input value="${data.gross || ""}"></td>
    <td><button class="btn-danger" onclick="this.parentNode.parentNode.remove(); renumber();">X</button></td>
  `;

  tbody.appendChild(tr);
}

function renumber() {
  [...document.querySelectorAll("#items tbody tr")].forEach((tr, i) => {
    tr.children[0].textContent = i + 1;
  });
}

function collect() {
  let rows = [...document.querySelectorAll("#items tbody tr")].map(tr => ({
    desc: tr.children[1].querySelector("input").value,
    qty: tr.children[2].querySelector("input").value,
    unit: tr.children[3].querySelector("input").value,
    net: tr.children[4].querySelector("input").value,
    gross: tr.children[5].querySelector("input").value
  }));

  return {
    id: Date.now(),
    company: company.value,
    shipper: shipper.value,
    consignee: consignee.value,
    packingNo: packingNo.value,
    packingDate: packingDate.value,
    reference: reference.value,
    contact: contact.value,
    notes: notes.value,
    rows
  };
}

function save() {
  let data = collect();
  archive.push(data);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(archive));
  renderArchive();
  alert("Saved!");
}

function renderArchive() {
  let tbody = document.querySelector("#archiveTable tbody");
  tbody.innerHTML = "";

  archive.forEach(entry => {
    let tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${entry.packingNo}</td>
      <td>${entry.packingDate}</td>
      <td>${entry.consignee.split("\n")[0] || ""}</td>
      <td><button onclick='load(${entry.id})'>Load</button></td>
      <td><button class="btn-danger" onclick='del(${entry.id})'>X</button></td>
    `;
    tbody.appendChild(tr);
  });
}

function load(id) {
  let data = archive.find(x => x.id === id);
  if (!data) return;

  company.value = data.company;
  shipper.value = data.shipper;
  consignee.value = data.consignee;
  packingNo.value = data.packingNo;
  packingDate.value = data.packingDate;
  reference.value = data.reference;
  contact.value = data.contact;
  notes.value = data.notes;

  document.querySelector("#items tbody").innerHTML = "";
  data.rows.forEach(r => addRow(r));
}

function del(id) {
  archive = archive.filter(x => x.id !== id);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(archive));
  renderArchive();
}

function newList() {
  location.reload();
}

renderArchive();
addRow();
</script>

</body>
</html>
